{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./source/helper/audioEngine.js","webpack:///./source/helper/constants.js","webpack:///./source/helper/gameBoard.js","webpack:///./source/helper/player.js","webpack:///./source/helper/score.js","webpack:///./source/helper/server.js","webpack:///./source/init.js","webpack:///./source/resource.js","webpack:///./source/scene/gameScene.js","webpack:///./source/scene/mainMenuScene.js","webpack:///./source/scene/scoreScene.js"],"names":["AudioEngine","audioEngine","cc","soundEnabled","playEffect","url","loop","Constants","SERVER_NAME","SUBMARINE_TYPE","BATTLESHIP_TYPE","DESTROYER_TYPE","CRUISER_TYPE","GID_FIRE","GID_WATER","GID_SHIP","GID_FALL","GID_INJURED","GameBoard","tmxFile","initWithTMXFile","mainLayer","getLayer","width","getContentSize","height","Rect","getPositionX","Math","floor","getPositionY","TMXTiledMap","Player","id","ownBoard","enemyBoard","enemyId","Score","_instance","instance","hits","misses","result","Server","serverName","webSocket","WebSocket","request","JSON","stringify","msg","send","row","column","userId","g_resources","i","push","window","app","start","sys","isNative","document","getElementById","body","removeChild","view","enableRetina","os","OS_IOS","isMobile","browserType","BROWSER_TYPE_BAIDU","BROWSER_TYPE_WECHAT","enableAutoFullScreen","style","backgroundColor","adjustViewPort","setDesignResolutionSize","ResolutionPolicy","FIXED_HEIGHT","resizeWithBrowserSize","LoaderScene","preload","director","runScene","res","battleShipField","type","src","backgroundSprite","backgroundOnWin","backgroundOnLost","GameFont","name","srcs","battleship_4","water","water_boat","water_falled","water_hitted","fire","fallSound","hitSound","audioIcon","audioDisableIcon","GameLayer","Layer","extend","ownBoardLayer","enemyBoardLayer","player","walkingUserId","ownBoardLabel","enemyBoardLabel","topBoardLabel","score","labelOnError","exitOneEnemyDisconnect","waitEnemyLabel","ctor","_super","Sprite","LabelTTF","ccui","Button","loadTextures","enableShadow","color","size","winSize","setAnchorPoint","scale","max","setScale","addChild","setFontFillColor","p","setPosition","margin","enemyBoardScale","ownBoardScale","exitButtonLabel","exitButtonMenuItem","MenuItemLabel","server","close","TransitionFade","menuExit","Menu","touchEnabled","_scale9Enabled","audioIconPos","Point","onmessage","data","parse","onConnection","onEnemyFound","onWin","onLost","enemyInjured","youInjured","youFall","enemyFall","enemyDisconnect","onUnknown","that","eventManager","addListener","event","EventListener","MOUSE","onMouseDown","x","getLocationX","y","getLocationY","fieldRect","getRect","rectContainsPoint","j","currentTile","getTileAt","tileX","getPositionAt","tileY","tileRect","rect","hit","log","soundButtonRect","_buttonNormalSpriteFrame","toggleSound","board","cell","setTileGID","getTileGIDAt","findRoom","isEnabled","setEnabled","_onPressStateChangedToNormal","string","GameScene","Scene","onEnter","layer","MainMenuLayer","visibleSize","getVisibleSize","origin","getVisibleOrigin","rX","rY","itemNewGameLabel","itemNewGame","play","mainMenu","MainMenuScene","ScoreLayer","resultLabel","playAgain","playAgainMenu","restart","menu","Color","ScoreScene"],"mappings":"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","file":"src/app.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./source/init.js\");\n","let AudioEngine = {\n\n    audioEngine: cc.audioEngine,\n    soundEnabled: true,\n\n    playEffect: function(url, loop) {\n        if (this.soundEnabled) {\n            this.audioEngine.playEffect(url, loop);\n        }\n    }\n};\n\nexport default AudioEngine;\n","const Constants = {\n    SERVER_NAME: \"ws://0.0.0.0:2346\",\n    SUBMARINE_TYPE: \"s\",\n    BATTLESHIP_TYPE: \"b\",\n    DESTROYER_TYPE: \"d\",\n    CRUISER_TYPE: \"c\",\n\n    GID_FIRE: 1,\n    GID_WATER: 2,\n    GID_SHIP: 3,\n    GID_FALL: 4,\n    GID_INJURED: 5\n};\n\nexport default Constants;\n\n\n\n","export default class GameBoard extends cc.TMXTiledMap {\n\n    /**\n     *\n     * @param tmxFile\n     */\n    constructor(tmxFile) {\n        super();\n        this.initWithTMXFile(tmxFile);\n        this.mainLayer = this.getLayer(\"Tile Layer 1\");\n        this.width     = this.mainLayer.getContentSize().width;\n        this.height    = this.mainLayer.getContentSize().height;\n    }\n\n    getRect() {\n        return new cc.Rect(this.getPositionX() - Math.floor(this.width / 2),\n                           this.getPositionY() - Math.floor(this.height / 2),\n                           Math.floor(this.width), Math.floor(this.height));\n    }\n}\n","export default class Player {\n\n    constructor(id = null) {\n        this.id         = id;\n        this.ownBoard   = null;\n        this.enemyBoard = null;\n        this.enemyId    = null;\n    }\n\n}","const Score = {\n    _instance: null,\n\n    get instance() {\n        if (!this._instance) {\n            this._instance = {\n                hits:  0,\n                misses:  0,\n                result: \"\",\n            };\n        }\n\n        return this._instance;\n    }\n};\n\nexport default Score;","export default class Server  {\n\n    constructor(serverName) {\n        this.serverName = serverName;\n        this.webSocket = new WebSocket(serverName);\n    }\n\n    findRoom() {\n        const request = JSON.stringify({\n            msg: \"findRoom\"\n        });\n\n        this.webSocket.send(request);\n    }\n\n    hit(row, column, userId) {\n        const request = JSON.stringify({\n            msg: \"hit\",\n            row: row,\n            column: column,\n            userId: userId\n        });\n\n        this.webSocket.send(request);\n    }\n}\n\n","import res from \"./resource\";\nimport MainMenuScene from \"./scene/mainMenuScene\";\n\nconst g_resources = [];\nfor (let i in res) {\n    g_resources.push(res[i]);\n}\n\nwindow.app = {};\n\nwindow.app.start = function() {\n    let sys = cc.sys;\n    if(!sys.isNative && document.getElementById(\"cocosLoading\")) //If referenced loading.js, please remove it\n        document.body.removeChild(document.getElementById(\"cocosLoading\"));\n\n    // Pass true to enable retina display, on Android disabled by default to improve performance\n    cc.view.enableRetina(sys.os === sys.OS_IOS);\n\n    // Disable auto full screen on baidu and wechat, you might also want to eliminate sys.BROWSER_TYPE_MOBILE_QQ\n    if (sys.isMobile &&\n        sys.browserType !== sys.BROWSER_TYPE_BAIDU &&\n        sys.browserType !== sys.BROWSER_TYPE_WECHAT) {\n        cc.view.enableAutoFullScreen(true);\n    }\n\n    document.getElementById(\"Cocos2dGameContainer\").style.backgroundColor = \"#000000\";\n\n    // Adjust viewport meta\n    cc.view.adjustViewPort(true);\n\n    // Uncomment the following line to set a fixed orientation for your game\n    // cc.view.setOrientation(cc.ORIENTATION_PORTRAIT);\n\n    // Setup the resolution policy and design resolution size\n    cc.view.setDesignResolutionSize(960, 640, cc.ResolutionPolicy.FIXED_HEIGHT);\n\n    cc.view.enableAutoFullScreen(true);\n\n    // The game will be resized when browser size change\n    cc.view.resizeWithBrowserSize(true);\n\n    //load resources\n    cc.LoaderScene.preload(g_resources, function () {\n        cc.director.runScene(new MainMenuScene());\n    }, this);\n}\n","const res = {\n    battleShipField: { type: \"tmx\", src: \"res/battleship.tmx\"},\n    backgroundSprite: { type: \"jpg\", src: \"res/backgrounds/mainBackground.jpg\"},\n    backgroundOnWin: { type: \"jpg\", src: \"res/backgrounds/on_win.jpg\"},\n    backgroundOnLost: { type: \"jpg\", src: \"res/backgrounds/on_lost.jpg\"},\n    GameFont: {\n        type:\"font\",\n        name:\"GameFont\",\n        srcs:[\"res/fonts/8-BIT_WONDER.ttf\", \"res/fonts/8-BIT_WONDER.ttf\"]\n    },\n    battleship_4: { type: \"png\", src: \"res/battleship_4.png\"},\n    water: { type: \"png\", src: \"res/water.png\"},\n    water_boat: { type: \"png\", src: \"res/water_boat.png\"},\n    water_falled: { type: \"png\", src: \"res/water_falled.png\"},\n    water_hitted: { type: \"png\", src: \"res/water_hitted.png\"},\n    fire: { type: \"png\", src: \"res/fire.png\"},\n    fallSound: { type: \"wav\", src: \"res/sounds/watersplash2.wav\"},\n    hitSound: { type: \"wav\", src: \"res/sounds/DeathFlash.wav\"},\n    audioIcon: { type: \"png\", src: \"res/sound_icon.png\"},\n    audioDisableIcon: { type: \"png\", src: \"res/sound_disable_icon.png\"}\n};\n\nexport default res;\n","import ScoreScene from \"./scoreScene\";\nimport AudioEngine from \"../helper/audioEngine\";\nimport Score from \"../helper/score\";\nimport Constants from \"../helper/constants\";\nimport Server from \"../helper/server\";\nimport GameBoard from \"../helper/gameBoard\";\nimport Player from \"../helper/player\";\nimport res from \"../resource\";\n\nlet GameLayer = cc.Layer.extend({\n\n    backgroundSprite: null,\n    ownBoardLayer: null,\n    enemyBoardLayer: null,\n    player: null,\n    walkingUserId: null,\n    ownBoardLabel: null,\n    enemyBoardLabel: null,\n    topBoardLabel: null,\n    score: null,\n    labelOnError: null,\n    exitOneEnemyDisconnect: false,\n    waitEnemyLabel: null,\n\n    ctor: function () {\n        this._super();\n        this.player            = new Player();\n        this.player.enemyBoard = new GameBoard(res.battleShipField.src);\n        this.player.ownBoard   = new GameBoard(res.battleShipField.src);\n        this.ownBoardLayer     = this.player.ownBoard.getLayer(\"Tile Layer 1\");\n        this.enemyBoardLayer   = this.player.enemyBoard.getLayer(\"Tile Layer 1\");\n        this.backgroundSprite  = new cc.Sprite(res.backgroundSprite.src);\n        this.ownBoardLabel     = new cc.LabelTTF(\"Your board\", \"GameFont\", 20);\n        this.enemyBoardLabel   = new cc.LabelTTF(\"Enemy board\", \"GameFont\", 20);\n        this.topBoardLabel     = new cc.LabelTTF(\"\", \"GameFont\", 21);\n        this.audioEngine       = AudioEngine;\n        this.audioIcon         = new ccui.Button();\n        this.waitEnemyLabel    = new cc.LabelTTF(\"Searching game...\", \"GameFont\", 20);\n        this.score             = Score.instance;\n        this.labelOnError      = new cc.LabelTTF(\"The enemy disconnected\", \"GameFont\", 16);\n        this.audioIcon.loadTextures(res.audioIcon.src, res.audioDisableIcon.src, res.audioDisableIcon.src);\n\n        this.ownBoardLabel.enableShadow(cc.color(100, 50, 50, 255), cc.size(4, 4), 0);\n        this.enemyBoardLabel.enableShadow(cc.color(100, 50, 50, 255), cc.size(4, 4), 0);\n\n        const size = cc.winSize;\n\n        this.size = size;\n\n        this.backgroundSprite.setAnchorPoint(0, 0);\n        const scale = Math.max(size.width / this.backgroundSprite.getContentSize().width,\n            size.height / this.backgroundSprite.getContentSize().height);\n        this.backgroundSprite.setScale(scale);\n\n        this.addChild(this.backgroundSprite);\n\n        this.waitEnemyLabel.setFontFillColor(cc.color(0, 50, 255, 200));\n        this.waitEnemyLabel.setAnchorPoint(cc.p(0.5, 0.5));\n        this.waitEnemyLabel.setPosition(cc.p(size.width / 2, size.height - size.height / 8));\n        this.addChild(this.waitEnemyLabel);\n\n        const margin = size.width / 14;\n\n        const enemyBoardScale = (size.height / 2) / this.player.enemyBoard.height;\n        this.player.enemyBoard.setAnchorPoint(cc.p(0.5, 0.5));\n        this.enemyBoardLayer.setScale(enemyBoardScale);\n        this.player.enemyBoard.setPosition(cc.p(size.width / 3 + 2 * size.width / 3 - size.width / 6 - margin, size.height / 2));\n        this.player.enemyBoard.width  = this.player.enemyBoard.width  * enemyBoardScale;\n        this.player.enemyBoard.height = this.player.enemyBoard.height * enemyBoardScale;\n\n        const ownBoardScale = (size.height / 2) / this.player.ownBoard.height;\n        this.player.ownBoard.setAnchorPoint(cc.p(0.5, 0.5));\n        this.ownBoardLayer.setScale(ownBoardScale);\n        this.player.ownBoard.setPosition(cc.p(size.width / 3 - size.width / 6 + margin, size.height / 2));\n        this.player.ownBoard.width  = this.player.ownBoard.width  * ownBoardScale;\n        this.player.ownBoard.height = this.player.ownBoard.height * ownBoardScale;\n\n        this.ownBoardLabel.setAnchorPoint(cc.p(0.5, 0.5));\n        this.ownBoardLabel.setPosition(cc.p(size.width / 3 - size.width / 6 + margin,\n            size.height / 2 + this.player.ownBoard.height / 2 + margin));\n        this.addChild(this.ownBoardLabel);\n\n        this.enemyBoardLabel.setAnchorPoint(cc.p(0.5, 0.5));\n        this.enemyBoardLabel.setPosition(cc.p(size.width / 3 + 2 * size.width / 3 - size.width / 6 - margin,\n            size.height / 2 + this.player.enemyBoard.height / 2 + margin));\n        this.addChild(this.enemyBoardLabel);\n\n        this.topBoardLabel.setAnchorPoint(cc.p(0.5, 0.5));\n        this.topBoardLabel.setPosition(cc.p(size.width / 2, size.height - size.height / 8));\n        this.addChild(this.topBoardLabel);\n\n        this.exitButtonLabel = new cc.LabelTTF(\"Exit\", \"GameFont\", 20);\n        this.exitButtonMenuItem = new cc.MenuItemLabel(this.exitButtonLabel, () => {\n            this.server.webSocket.close();\n            this.score.result = this.exitOneEnemyDisconnect ? \"win\" : \"lost\";\n            cc.director.runScene(new cc.TransitionFade(0.5, new ScoreScene(), cc.color(1, 1, 1, 1)));\n        });\n        this.exitButtonMenuItem.setAnchorPoint(cc.p(0, 0));\n        this.exitButtonMenuItem.setPosition(size.width / 16, size.height - size.height / 12);\n        this.menuExit = new cc.Menu(this.exitButtonMenuItem);\n        this.menuExit.setPosition(cc.p(0, 0));\n        this.addChild(this.menuExit);\n\n        this.addChild(this.player.enemyBoard);\n        this.addChild(this.player.ownBoard);\n\n        this.audioIcon.touchEnabled = true;\n        this.audioIcon._scale9Enabled = true;\n\n        const audioIconPos = new cc.Point(size.width - size.width / 12, size.height - size.height / 12);\n        this.audioIcon.setPosition(audioIconPos);\n\n        this.addChild(this.audioIcon);\n\n        this.server = new Server(Constants.SERVER_NAME);\n        this.server.webSocket.onmessage = (data) => {\n            const msg = JSON.parse(data.data);\n            switch (msg.msg) {\n                case \"onConnection\":\n                    this.onConnection(msg);\n                    break;\n                case \"enemyFound\":\n                    this.onEnemyFound(msg);\n                    break;\n                case \"win\":\n                    this.onWin(msg);\n                    break;\n                case \"lost\":\n                    this.onLost(msg);\n                    break;\n                case \"enemyInjured\":\n                    this.enemyInjured(msg);\n                    break;\n                case \"youInjured\":\n                    this.youInjured(msg);\n                    break;\n                case \"youFall\":\n                    this.youFall(msg);\n                    break;\n                case \"enemyFall\":\n                    this.enemyFall(msg);\n                    break;\n                case \"enemyDisconnect\":\n                    this.enemyDisconnect(msg);\n                    break;\n                default:\n                    this.onUnknown(msg);\n                    break;\n            }\n        };\n\n        let that = this;\n        cc.eventManager.addListener({\n            event: cc.EventListener.MOUSE,\n\n            onMouseDown: function (event) {\n                const x = event.getLocationX();\n                const y = event.getLocationY();\n\n                let fieldRect = that.player.enemyBoard.getRect();\n\n                if (cc.rectContainsPoint(fieldRect, cc.p(Math.floor(x), Math.floor(y)))) {\n                    for (let i = 0; i < 10; i++) {\n                        for (let j = 0; j < 10; j++) {\n                            let currentTile = that.enemyBoardLayer.getTileAt(cc.p(i, j));\n                            const tileX = that.enemyBoardLayer.getPositionAt(cc.p(i, j)).x\n                                + that.player.enemyBoard.getPositionX()\n                                - that.player.enemyBoard.width / 2;\n                            const tileY = that.enemyBoardLayer.getPositionAt(cc.p(i, j)).y\n                                + that.player.enemyBoard.getPositionY()\n                                - that.player.enemyBoard.height / 2;\n                            let tileRect = new cc.rect(tileX, tileY, currentTile.width, currentTile.height);\n\n                            if (cc.rectContainsPoint(tileRect, cc.p(x, y)) && that.walkingUserId === that.player.id) {\n                                that.server.hit(i, j, that.player.enemyId);\n                            }\n                        }\n                    }\n                    cc.log(\"Clicked on enemyBoardField\");\n                }\n\n                let soundButtonRect = new cc.rect(Math.floor(audioIconPos.x - that.audioIcon._buttonNormalSpriteFrame.getRect().width / 2),\n                                                  Math.floor(audioIconPos.y - that.audioIcon._buttonNormalSpriteFrame.getRect().height / 2),\n                                                  that.audioIcon._buttonNormalSpriteFrame.getRect().width,\n                                                  that.audioIcon._buttonNormalSpriteFrame.getRect().height);\n                if (cc.rectContainsPoint(soundButtonRect, cc.p(Math.floor(x), Math.floor(y)))) {\n                    that.toggleSound();\n                }\n            }\n        }, this);\n\n        return true;\n    },\n\n    enemyDisconnect: function (msg) {\n        this.labelOnError.setAnchorPoint(cc.p(0.5, 0.5));\n        this.exitOneEnemyDisconnect = true;\n        this.labelOnError.setFontFillColor(cc.color(200, 0, 0));\n        this.labelOnError.setPosition(cc.p(this.size.width / 2, this.size.height - this.size.height / 14));\n        this.addChild(this.labelOnError);\n    },\n\n    onConnection: function(msg) {\n        cc.log(\"Connection has been established\");\n\n        this.board = msg.board;\n\n        cc.log(this.board);\n\n        for (let i = 0; i < 10; i++) {\n            for (let j = 0; j < 10; j++) {\n                let cell = this.board[j + i * 10];\n                if (   cell === Constants.SUBMARINE_TYPE || cell === Constants.BATTLESHIP_TYPE\n                    || cell === Constants.DESTROYER_TYPE || cell === Constants.CRUISER_TYPE) {\n                    this.ownBoardLayer.setTileGID(Constants.GID_SHIP, cc.p(i, j));\n                    cc.log(this.ownBoardLayer.getTileGIDAt(cc.p(i, j)));\n                }\n            }\n        }\n\n        this.player.id = msg.id;\n        this.server.findRoom();\n    },\n\n    toggleSound: function() {\n        this.audioEngine.soundEnabled = !this.audioEngine.soundEnabled;\n        if (this.audioIcon.isEnabled()) {\n            this.audioIcon.setEnabled(false);\n        } else {\n            this.audioIcon.setEnabled(true);\n            this.audioIcon._onPressStateChangedToNormal();\n        }\n    },\n\n    onEnemyFound: function (msg) {\n        this.removeChild(this.waitEnemyLabel);\n        this.player.enemyId = msg.enemyId;\n        this.walkingUserId = msg.walkingUserId;\n        if (this.walkingUserId === this.player.id) {\n            this.topBoardLabel.string = \"Your action\";\n        } else {\n            this.topBoardLabel.string = \"Enemy action\";\n        }\n        cc.log(\"Enemy found. EnemyId = \" + this.player.enemyId);\n        cc.log(\"Walking user id = \" + this.walkingUserId);\n    },\n\n    onWin: function (msg) {\n        cc.log(\"You win!\");\n        this.topBoardLabel.string = \"You win\";\n        this.score.result = \"win\";\n        this.server.webSocket.close();\n        cc.director.runScene(new cc.TransitionFade(0.5, new ScoreScene(), cc.color(1, 1, 1, 1)));\n    },\n\n    onLost: function (msg) {\n        cc.log(\"You lost\");\n        this.topBoardLabel.string = \"You lost\";\n        this.score.result = \"lost\";\n        this.server.webSocket.close();\n        cc.director.runScene(new cc.TransitionFade(0.5, new ScoreScene(), cc.color(1, 1, 1, 1)));\n    },\n\n    onUnknown: function (msg) {\n        cc.log(msg.msg);\n    },\n\n    enemyInjured: function (msg) {\n        this.enemyBoardLayer.setTileGID(Constants.GID_INJURED, cc.p(msg.row, msg.column));\n        this.audioEngine.playEffect(res.hitSound.src, false);\n        this.score.hits++;\n    },\n\n    youInjured: function (msg) {\n        cc.log(\"You injured at \" + msg.row + \" \" + msg.column);\n        this.ownBoardLayer.setTileGID(Constants.GID_INJURED, cc.p(msg.row, msg.column));\n        this.audioEngine.playEffect(res.hitSound.src, false);\n    },\n\n    youFall: function (msg) {\n        this.enemyBoardLayer.setTileGID(Constants.GID_FALL, cc.p(msg.row, msg.column));\n        this.walkingUserId = this.player.enemyId;\n        this.topBoardLabel.string = \"Enemy action\";\n        this.audioEngine.playEffect(res.fallSound.src, false);\n        this.score.misses++;\n    },\n\n    enemyFall: function (msg) {\n        cc.log(\"Enemy fall at \" + msg.row + \" \" + msg.column);\n        this.ownBoardLayer.setTileGID(Constants.GID_FALL, cc.p(msg.row, msg.column));\n        this.walkingUserId = this.player.id;\n        this.topBoardLabel.string = \"Your action\";\n        this.audioEngine.playEffect(res.fallSound.src, false);\n    },\n});\n\nlet GameScene = cc.Scene.extend({\n    onEnter: function () {\n        this._super();\n        let layer = new GameLayer();\n        this.addChild(layer);\n    }\n});\n\nexport default GameScene;\n","import res from \"../resource\";\nimport GameScene from \"./gameScene\";\n\nlet MainMenuLayer = cc.Layer.extend({\n\n    backgroundSprite: null,\n\n    ctor: function () {\n        this._super();\n        this.backgroundSprite  = new cc.Sprite(res.backgroundSprite.src);\n\n        const size = cc.winSize;\n\n        const visibleSize = cc.director.getVisibleSize();\n        const origin = cc.director.getVisibleOrigin();\n\n        this.backgroundSprite.setPosition(cc.p(visibleSize.width / 2 + origin.x, visibleSize.height / 2 + origin.y));\n\n        this.addChild(this.backgroundSprite, -1);\n        const rX = visibleSize.width / this.backgroundSprite.getContentSize().width;\n        const rY = visibleSize.height / this.backgroundSprite.getContentSize().height;\n\n        this.backgroundSprite.setScale(rX, rY);\n\n        // Create the main menu\n\n        let itemNewGameLabel = new cc.LabelTTF(\"Start Game\", \"GameFont\", 26);\n        itemNewGameLabel.enableShadow(cc.color(50, 100, 100, 255), cc.size(4, 4), 0);\n\n        let itemNewGame =  new cc.MenuItemLabel(itemNewGameLabel, play);\n\n        itemNewGame.setPosition(cc.p(size.width / 2, (size.height / 6) * 4));\n\n        let mainMenu = new cc.Menu(itemNewGame);\n        mainMenu.setPosition(cc.p(0, 0));\n        this.addChild(mainMenu);\n\n        return true;\n    }\n});\n\nlet play = function() {\n    cc.log(\"Play button\");\n    cc.director.runScene(new cc.TransitionFade(0.5, new GameScene(), cc.color(1, 1, 1, 1)));\n};\n\nlet MainMenuScene = cc.Scene.extend({\n    onEnter: function () {\n        this._super();\n        let layer = new MainMenuLayer();\n        this.addChild(layer);\n    }\n});\n\nexport default MainMenuScene;\n","import GameScene from \"./gameScene\";\nimport Score from \"../helper/score\";\n\nlet ScoreLayer = cc.Layer.extend({\n\n    resultLabel: null,\n    hits: null,\n    misses: null,\n    score: null,\n    playAgain: null,\n    playAgainMenu: null,\n    backgroundSprite: null,\n\n    ctor: function() {\n        this._super();\n        this.score            = Score.instance;\n        this.resultLabel      = new cc.LabelTTF(this.score.result === \"win\" ? \"You win\" : \"You lost\",\n            \"GameFont\", 28);\n        this.hits             = new cc.LabelTTF(\"Hits: \" + this.score.hits, \"GameFont\", 20);\n        this.misses           = new cc.LabelTTF(\"Misses: \" + this.score.misses, \"GameFont\", 20);\n        this.playAgain        = new cc.LabelTTF(\"Play again\", \"GameFont\", 26);\n        this.playAgainMenu    = new cc.MenuItemLabel(this.playAgain, this.restart);\n        this.backgroundSprite = new cc.Sprite(this.score.result === \"win\" ? res.backgroundOnWin.src : res.backgroundOnLost.src);\n\n        const size = cc.winSize;\n\n        this.backgroundSprite.setAnchorPoint(0, 0);\n        const scale = Math.max(size.width / this.backgroundSprite.getContentSize().width,\n            size.height / this.backgroundSprite.getContentSize().height);\n        this.backgroundSprite.setScale(scale);\n\n        this.resultLabel.setAnchorPoint(cc.p(0.5, 0.5));\n        this.hits.setAnchorPoint(cc.p(0.5, 0.5));\n        this.misses.setAnchorPoint(cc.p(0.5, 0.5));\n        this.playAgainMenu.setAnchorPoint(cc.p(0.5, 0.5));\n\n        this.resultLabel.setPosition(cc.p(size.width / 2, size.height - size.height / 12));\n        this.hits.setPosition(cc.p(size.width / 2, size.height / 1.8));\n        this.misses.setPosition(cc.p(size.width / 2, size.height / 2.8));\n        this.playAgainMenu.setPosition(cc.p(size.width / 2, size.height / 10));\n\n        this.menu = new cc.Menu(this.playAgainMenu);\n        this.menu.setPosition(cc.p(0, 0));\n\n        this.addChild(this.backgroundSprite);\n        this.addChild(this.resultLabel);\n        this.addChild(this.hits);\n        this.addChild(this.misses);\n        this.addChild(this.menu);\n    },\n\n    restart: function() {\n        cc.director.runScene(new cc.TransitionFade(0.5, new GameScene(), cc.Color(1, 1, 1, 1)));\n    }\n});\n\nlet ScoreScene = cc.Scene.extend({\n    onEnter: function() {\n        this._super();\n        let layer = new ScoreLayer();\n        this.addChild(layer);\n    }\n});\n\nexport default ScoreScene;"],"sourceRoot":""}